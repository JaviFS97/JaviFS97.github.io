<!DOCTYPE html><html lang="es" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="Zerologon Vulnerability Implementation" /><meta name="author" content="Javier Fernández Santos" /><meta property="og:locale" content="es" /><meta name="description" content="In this post I intend to implement the vulnerability known as Zerologon that allows an attacker to gain full control over a domain server in the Active Directory domain server." /><meta property="og:description" content="In this post I intend to implement the vulnerability known as Zerologon that allows an attacker to gain full control over a domain server in the Active Directory domain server." /><link rel="canonical" href="https://javifs97.github.io/posts/vulnerability-zerologon/" /><meta property="og:url" content="https://javifs97.github.io/posts/vulnerability-zerologon/" /><meta property="og:site_name" content="JaviFS97" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-02-15T11:12:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Zerologon Vulnerability Implementation" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"Javier Fernández Santos"},"description":"In this post I intend to implement the vulnerability known as Zerologon that allows an attacker to gain full control over a domain server in the Active Directory domain server.","url":"https://javifs97.github.io/posts/vulnerability-zerologon/","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://javifs97.github.io/posts/vulnerability-zerologon/"},"headline":"Zerologon Vulnerability Implementation","dateModified":"2022-09-19T17:25:43+02:00","datePublished":"2022-02-15T11:12:00+01:00","@context":"https://schema.org"}</script><title>Zerologon Vulnerability Implementation | JaviFS97</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="JaviFS97"><meta name="application-name" content="JaviFS97"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/avatar/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">JaviFS97</a></div><div class="site-subtitle font-italic">Welcome! I'm javier, and in this blog is my personal space where I share articles on certain topics, research I do in my lab, CTF write-ups, and quick notes on things I want to remember. and quick notes on things I want to remember.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT ME</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/JaviFS97" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://www.linkedin.com/in/JaviFS97" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Zerologon Vulnerability Implementation</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Zerologon Vulnerability Implementation</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/JaviFS97">Javier Fernández Santos</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" date="2022-02-15 11:12:00 +0100" data-toggle="tooltip" data-placement="bottom" title="Tue, Feb 15, 2022, 11:12 AM +0100" >Feb 15</em> </span> <span> Updated <em class="timeago" date="2022-09-19 08:25:43 -0700 " data-toggle="tooltip" data-placement="bottom" title="Mon, Sep 19, 2022, 8:25 AM -0700" >Sep 19</em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1303 words"> <em>7 min</em> read</span></div></div></div><div class="post-content"><p>In this post I intend to implement the vulnerability known as Zerologon that allows an attacker to gain full control over a domain server in the Active Directory domain server.</p><p>The vulnerability acts within the scope of the Netlogon protocol, used in Windows domain servers to, among other things, facilitate access to users who want to log in to the server using an account and password.</p><h1 id="post-index">Post index</h1><ul><li><a href="#introduction">Introduction</a><li><a href="#how-to-reproduce-it-">How to reproduce it ?</a><li><a href="#results">Results</a><li><a href="#conclusions">Conclusions</a><li><a href="#code-developed">Code developed</a></ul><h1 id="introduction">Introduction</h1><p>The attack described here<sup id="fnref:1" role="doc-noteref"><a href="#fn:1" class="footnote" rel="footnote">1</a></sup> takes advantage of flaws in a cryptographic authentication protocol that proves the authenticity and identity of a domain-joined computer to the DC. <strong>Due to incorrect use of an AES mode of operation it is possible to spoof the identity of any computer account (including that of the DC itself) and set an empty password for that account in the domain.</strong></p><p>To carry out this project, I read the detailed indications in the report<sup id="fnref:1:1" role="doc-noteref"><a href="#fn:1" class="footnote" rel="footnote">1</a></sup> and through it I determine the steps I must follow to exploit the vulnerability.</p><p>In this case, I’m not going to specify how it works, but rather how to create the code to exploit the vulnerability. If you want to understand why it works, read the report<sup id="fnref:1:2" role="doc-noteref"><a href="#fn:1" class="footnote" rel="footnote">1</a></sup> where it is detailed.</p><p>What must be implemented to exploit the vulnerability is what you see in the following image (Figure 1).</p><p><img data-proofer-ignore data-src="/assets/img/posts/20220215/0.proceso.png" alt="Figure 1" class="shadow" style="min-width: 50%;" /> <em>Figure 1 - When encrypting a message consisting only of zeroes, with an all-zero IV, there is a 1 in 256 chance that the output will only contain zeroes as well.</em></p><h1 id="how-to-reproduce-it-">How to reproduce it ?</h1><p>To ensure that the cryptogram is made up exclusively of zeros, the following must be taken into account:</p><ul><li>IV → All zeros.<li>Message → All zeros.<li>Key → Since the length of the key is 8 bits, there are 2^8 = 256 combinations of keys. Some one of the 256 combinations will generate as output a zero. This will cause the cryptogram to be zeros.</ul><p>We are going to comment the most important parts (All the code is attached at the end of the post to be able to see it complete and execute it):</p><ol><li><p><strong>Initialization:</strong> We start with the requirements stipulated in Figure 1 and the CFB8 block cipher mode. <img data-proofer-ignore data-src="/assets/img/posts/20220215/1.init.png" alt="Figure 2" class="shadow" style="min-width: 50%;" /> <em>Figure 2 - Initialization proccess.</em></p><li><p><strong>Encryption and decryption functions:</strong> they receive the message or cryptogram, followed by the key and the IV. <img data-proofer-ignore data-src="/assets/img/posts/20220215/2.cifrado.png" alt="Figure 3" class="shadow" style="min-width: 50%;" /> <em>Figure 3 - Encryption and decryption functions.</em></p><li><p><strong>Brute force to obtain the cryptogram we want:</strong> for each attempt, a key is randomly generated. We check if the cryptogram generated with the generated cryptogram is all zeros. Finally, a series of statistics are printed to see if any cryptogram is equal to zero and the position of the attempt. equal to zero and the position of the attempt. <img data-proofer-ignore data-src="/assets/img/posts/20220215/3.fuerza.png" alt="Figure 4" class="shadow" style="min-width: 50%;" /> <em>Figure 4 - Brute force to obtain the cryptogram we want:.</em></p><li><p><strong>Random string generation function.</strong> <img data-proofer-ignore data-src="/assets/img/posts/20220215/4.claves.png" alt="Figure 5" class="shadow" style="min-width: 50%;" /> <em>Figure 5 - Random string generation function.</em></p></ol><h1 id="results">Results</h1><p>One of the executions generates a match among 256 attempts made, see it in Figure 6. <img data-proofer-ignore data-src="/assets/img/posts/20220215/5.ejec1.png" alt="Figure 6" class="shadow" style="min-width: 50%;" /> <em>Figure 6 - Results 1</em></p><p>If we go to position 77, as shown in the previous image, we can see that the cryptogram is all zeros. <img data-proofer-ignore data-src="/assets/img/posts/20220215/6.ejec1.png" alt="Figure 7" class="shadow" style="min-width: 50%;" /> <em>Figure 7 - Results 2</em></p><p>But that will not always be the case. There will be times when the number of matches is zero. This is because the random string generation function is not as random as it seems and does not generate all possible combinations. <img data-proofer-ignore data-src="/assets/img/posts/20220215/7.ejec2.png" alt="Figure 8" class="shadow" style="min-width: 50%;" /> <em>Figure 8 - Results 3</em></p><p>On the other hand, there will be occasions when the opposite is true. In this case there are two coincidences. <img data-proofer-ignore data-src="/assets/img/posts/20220215/8.ejec3.png" alt="Figure 9" class="shadow" style="min-width: 50%;" /> <em>Figure 9 - Results 4</em></p><h1 id="conclusions">Conclusions</h1><p>By simply sending a number of Netlogon messages in which various fields are filled with zeroes, an attacker can change the computer password of the domain controller that is stored in the AD. This can then be used to obtain domain admin credentials and then restore the original DC password.</p><h1 id="code-developed">Code developed</h1><p>Here you have the code developed to exploit CVE-2020-1472 vulnerability.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">java.io.UnsupportedEncodingException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.nio.charset.Charset</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.security.InvalidAlgorithmParameterException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.security.InvalidKeyException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.security.NoSuchAlgorithmException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.security.SecureRandom</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.ArrayList</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.crypto.BadPaddingException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.crypto.Cipher</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.crypto.IllegalBlockSizeException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.crypto.KeyGenerator</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.crypto.NoSuchPaddingException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.crypto.SecretKey</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.crypto.spec.IvParameterSpec</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.crypto.spec.SecretKeySpec</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">jakarta.xml.bind.DatatypeConverter</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Cryptor</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="nc">Cipher</span> <span class="n">cipher</span><span class="o">;</span>
    <span class="kd">static</span> <span class="kt">int</span> <span class="n">numIntentos</span> <span class="o">=</span> <span class="mi">256</span><span class="o">;</span>
    <span class="kd">static</span> <span class="kt">byte</span><span class="o">[]</span> <span class="n">iv</span> <span class="o">=</span> <span class="o">{</span><span class="mh">0x00</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">,</span>
            <span class="mh">0x00</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">};</span>
    
    <span class="kd">static</span> <span class="kt">byte</span><span class="o">[]</span> <span class="n">text</span> <span class="o">=</span> <span class="o">{</span><span class="mh">0x00</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">,</span>
            <span class="mh">0x00</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">};</span>
    
    <span class="kd">private</span> <span class="kd">static</span> <span class="nc">Charset</span> <span class="no">CHARSET</span> <span class="o">=</span> <span class="nc">Charset</span><span class="o">.</span><span class="na">forName</span><span class="o">(</span><span class="s">"ISO-8859-1"</span><span class="o">);</span>

    <span class="kd">public</span> <span class="nf">Cryptor</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">CryptingException</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">cipher</span> <span class="o">=</span> <span class="nc">Cipher</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">"AES/CFB8/NoPadding"</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">NoSuchAlgorithmException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">SecurityException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">NoSuchPaddingException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">SecurityException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">byte</span><span class="o">[]</span> <span class="nf">decrypt</span><span class="o">(</span><span class="kt">byte</span><span class="o">[]</span> <span class="n">input</span><span class="o">,</span> <span class="nc">SecretKey</span> <span class="n">keySpec</span><span class="o">,</span> <span class="nc">IvParameterSpec</span> <span class="n">ivSpec</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">CryptingException</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">cipher</span><span class="o">.</span><span class="na">init</span><span class="o">(</span><span class="nc">Cipher</span><span class="o">.</span><span class="na">DECRYPT_MODE</span><span class="o">,</span> <span class="n">keySpec</span><span class="o">,</span> <span class="n">ivSpec</span><span class="o">);</span>
            <span class="k">return</span> <span class="n">cipher</span><span class="o">.</span><span class="na">doFinal</span><span class="o">(</span><span class="n">input</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">IllegalBlockSizeException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">SecurityException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">BadPaddingException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">SecurityException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">InvalidKeyException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">SecurityException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">InvalidAlgorithmParameterException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">SecurityException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">byte</span><span class="o">[]</span> <span class="nf">encrypt</span><span class="o">(</span><span class="kt">byte</span><span class="o">[]</span> <span class="n">input</span><span class="o">,</span> <span class="nc">SecretKey</span> <span class="n">keySpec</span><span class="o">,</span> <span class="nc">IvParameterSpec</span> <span class="n">ivSpec</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">CryptingException</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">cipher</span><span class="o">.</span><span class="na">init</span><span class="o">(</span><span class="nc">Cipher</span><span class="o">.</span><span class="na">ENCRYPT_MODE</span><span class="o">,</span> <span class="n">keySpec</span><span class="o">,</span> <span class="n">ivSpec</span><span class="o">);</span>
            <span class="k">return</span> <span class="n">cipher</span><span class="o">.</span><span class="na">doFinal</span><span class="o">(</span><span class="n">input</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">InvalidKeyException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">SecurityException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">InvalidAlgorithmParameterException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">SecurityException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">IllegalBlockSizeException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">SecurityException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">BadPaddingException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">SecurityException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span> <span class="nc">Args</span><span class="o">[])</span> <span class="kd">throws</span> <span class="nc">UnsupportedEncodingException</span> <span class="o">{</span>

        <span class="k">try</span> <span class="o">{</span>
            <span class="nc">Cryptor</span> <span class="n">c</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Cryptor</span><span class="o">();</span>

        	<span class="kt">int</span> <span class="n">cont</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        	<span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">posiciones</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;();</span>
            <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nc">Cryptor</span><span class="o">.</span><span class="na">numIntentos</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
                <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Posicion: "</span> <span class="o">+</span> <span class="n">i</span><span class="o">);</span>
                <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"TEXT    -&gt; 0x"</span> <span class="o">+</span> <span class="nc">DatatypeConverter</span><span class="o">.</span><span class="na">printHexBinary</span><span class="o">(</span><span class="n">text</span><span class="o">));</span>
                
            	<span class="c1">// KEY</span>
            	<span class="nc">String</span> <span class="n">secretKey</span> <span class="o">=</span> <span class="n">generateRandomString</span><span class="o">(</span><span class="mi">16</span><span class="o">);</span>
            	<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"KEY     -&gt; "</span> <span class="o">+</span> <span class="n">secretKey</span><span class="o">);</span>
            	<span class="nc">SecretKey</span> <span class="n">keySpec</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SecretKeySpec</span><span class="o">(</span><span class="n">secretKey</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(</span><span class="no">CHARSET</span><span class="o">),</span> <span class="s">"AES"</span><span class="o">);</span>
            	
            	<span class="c1">// IV</span>
                <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"IV      -&gt; 0x"</span> <span class="o">+</span> <span class="nc">DatatypeConverter</span><span class="o">.</span><span class="na">printHexBinary</span><span class="o">(</span><span class="nc">Cryptor</span><span class="o">.</span><span class="na">iv</span><span class="o">));</span>
                <span class="nc">IvParameterSpec</span> <span class="n">ivSpec</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">IvParameterSpec</span><span class="o">(</span><span class="nc">Cryptor</span><span class="o">.</span><span class="na">iv</span><span class="o">);</span>
            	
                <span class="c1">// ENCRYPT</span>
                <span class="kt">byte</span><span class="o">[]</span> <span class="n">encrypted</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="na">encrypt</span><span class="o">(</span><span class="nc">Cryptor</span><span class="o">.</span><span class="na">text</span><span class="o">,</span> <span class="n">keySpec</span><span class="o">,</span> <span class="n">ivSpec</span><span class="o">);</span>
                <span class="k">if</span> <span class="o">(</span><span class="nc">DatatypeConverter</span><span class="o">.</span><span class="na">printHexBinary</span><span class="o">(</span><span class="n">encrypted</span><span class="o">).</span><span class="na">contains</span><span class="o">(</span><span class="s">"00000000000000000000000000000000"</span><span class="o">))</span> <span class="o">{</span>	
                	<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Encoded -&gt; 0x"</span> <span class="o">+</span> <span class="nc">DatatypeConverter</span><span class="o">.</span><span class="na">printHexBinary</span><span class="o">(</span><span class="n">encrypted</span><span class="o">)</span> <span class="o">+</span> <span class="s">" &lt;--------------- ####### UN RESULTADO #######"</span><span class="o">);</span>
                	<span class="n">cont</span><span class="o">++;</span>
                	<span class="n">posiciones</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="nc">Integer</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">i</span><span class="o">));</span>
                <span class="o">}</span>
                <span class="k">else</span> 
                	<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Encoded -&gt; 0x"</span> <span class="o">+</span> <span class="nc">DatatypeConverter</span><span class="o">.</span><span class="na">printHexBinary</span><span class="o">(</span><span class="n">encrypted</span><span class="o">));</span>
                
                <span class="c1">//DECRYPT</span>
                <span class="kt">byte</span><span class="o">[]</span> <span class="n">decrypted</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="na">decrypt</span><span class="o">(</span><span class="n">encrypted</span><span class="o">,</span> <span class="n">keySpec</span><span class="o">,</span> <span class="n">ivSpec</span><span class="o">);</span>
                <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Decoded -&gt; 0x"</span> <span class="o">+</span> <span class="nc">DatatypeConverter</span><span class="o">.</span><span class="na">printHexBinary</span><span class="o">(</span><span class="n">decrypted</span><span class="o">));</span>
                
                <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"------------------------------------"</span><span class="o">);</span>
			<span class="o">}</span>

            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"####### RESULTADOS #######"</span><span class="o">);</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Numero intentos   -&gt; "</span> <span class="o">+</span> <span class="nc">Cryptor</span><span class="o">.</span><span class="na">numIntentos</span><span class="o">);</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Coincidencias     -&gt; "</span> <span class="o">+</span> <span class="n">cont</span><span class="o">);</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"En las posiciones -&gt; "</span> <span class="o">+</span> <span class="n">posiciones</span><span class="o">);</span>
            

        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">CryptingException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">String</span> <span class="nf">generateRandomString</span><span class="o">(</span><span class="kt">int</span> <span class="n">length</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">String</span> <span class="no">CHAR_LOWER</span> <span class="o">=</span> <span class="s">"abcdefghijklmnopqrstuvwxyz"</span><span class="o">;</span>
        <span class="nc">String</span> <span class="no">CHAR_UPPER</span> <span class="o">=</span> <span class="no">CHAR_LOWER</span><span class="o">.</span><span class="na">toUpperCase</span><span class="o">();</span>
        <span class="nc">String</span> <span class="no">NUMBER</span> <span class="o">=</span> <span class="s">"0123456789"</span><span class="o">;</span>

        <span class="nc">String</span> <span class="no">DATA_FOR_RANDOM_STRING</span> <span class="o">=</span> <span class="no">CHAR_LOWER</span> <span class="o">+</span> <span class="no">CHAR_UPPER</span> <span class="o">+</span> <span class="no">NUMBER</span><span class="o">;</span>
        <span class="nc">SecureRandom</span> <span class="n">random</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SecureRandom</span><span class="o">();</span>

        <span class="k">if</span> <span class="o">(</span><span class="n">length</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="o">)</span> <span class="k">throw</span> <span class="k">new</span> <span class="nc">IllegalArgumentException</span><span class="o">();</span>

        <span class="nc">StringBuilder</span> <span class="n">sb</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">StringBuilder</span><span class="o">(</span><span class="n">length</span><span class="o">);</span>
        
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="kt">int</span> <span class="n">rndCharAt</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="no">DATA_FOR_RANDOM_STRING</span><span class="o">.</span><span class="na">length</span><span class="o">());</span>
            <span class="kt">char</span> <span class="n">rndChar</span> <span class="o">=</span> <span class="no">DATA_FOR_RANDOM_STRING</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="n">rndCharAt</span><span class="o">);</span>

            <span class="n">sb</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">rndChar</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="k">return</span> <span class="n">sb</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">class</span> <span class="nc">CryptingException</span> <span class="kd">extends</span> <span class="nc">RuntimeException</span> <span class="o">{</span>

        <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">7123322995084333687L</span><span class="o">;</span>

        <span class="kd">public</span> <span class="nf">CryptingException</span><span class="o">()</span> <span class="o">{</span>
            <span class="kd">super</span><span class="o">();</span>
        <span class="o">}</span>

        <span class="kd">public</span> <span class="nf">CryptingException</span><span class="o">(</span><span class="nc">String</span> <span class="n">message</span><span class="o">)</span> <span class="o">{</span>
            <span class="kd">super</span><span class="o">(</span><span class="n">message</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><hr /><h3 id="reverse-footnote">Reverse Footnote<a href="#reverse-footnote"><i class="fas fa-hashtag"></i></a></h3></h3><div class="footnotes" role="doc-endnotes"><ol><li id="fn:1" role="doc-endnote"><p><a href="https://www.secura.com/uploads/whitepapers/Zerologon.pdf">Zerologon: Unauthenticated domain controller compromise by subverting Netlogon cryptography (CVE-2020-1472) by Tom Tervoort, September 2020 WHITEPAPER</a> [Accessed at: 02-2022] <a href="#fnref:1" class="reversefootnote" role="doc-backlink">&#8617;</a> <a href="#fnref:1:1" class="reversefootnote" role="doc-backlink">&#8617;<sup>2</sup></a> <a href="#fnref:1:2" class="reversefootnote" role="doc-backlink">&#8617;<sup>3</sup></a></p></ol></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/cybersecurity/'>Cybersecurity</a>, <a href='/categories/vulnerability-analytics/'>Vulnerability Analytics</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/vulnerability/" class="post-tag no-text-decoration" >Vulnerability</a> <a href="/tags/zerologon/" class="post-tag no-text-decoration" >Zerologon</a> <a href="/tags/cryptography/" class="post-tag no-text-decoration" >Cryptography</a> <a href="/tags/cve-2020-1472/" class="post-tag no-text-decoration" >CVE-2020-1472</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Zerologon Vulnerability Implementation - JaviFS97&url=https://javifs97.github.io/posts/vulnerability-zerologon/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Zerologon Vulnerability Implementation - JaviFS97&u=https://javifs97.github.io/posts/vulnerability-zerologon/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Zerologon Vulnerability Implementation - JaviFS97&url=https://javifs97.github.io/posts/vulnerability-zerologon/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recent Update</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/vulnerability-zerologon/">Zerologon Vulnerability Implementation</a><li><a href="/posts/TFG/">TFG - Sistema de control y administración de una red de garajes inteligentes y automatizados</a><li><a href="/posts/TFM/">Use of Natural Language Processing techniques for the automatic identification of TTPs in Threat Intelligence Reports.</a><li><a href="/posts/seg-ofensiva-introduccion/">Introducción al Hacking Ético y Penetration Testing</a><li><a href="/posts/seg-ofensiva-explotacion-vuln-red/">Explotación de vulnerabilidades en Red</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/pentesting/">Pentesting</a> <a class="post-tag" href="/tags/nmap/">NMAP</a> <a class="post-tag" href="/tags/archive-org/">Archive.org</a> <a class="post-tag" href="/tags/armitage/">Armitage</a> <a class="post-tag" href="/tags/arpspoofing/">ARPspoofing</a> <a class="post-tag" href="/tags/automatizaci%C3%B3n/">Automatización</a> <a class="post-tag" href="/tags/bettercap/">Bettercap</a> <a class="post-tag" href="/tags/burpsuite/">BurpSuite</a> <a class="post-tag" href="/tags/cpe/">CPE</a> <a class="post-tag" href="/tags/cryptography/">Cryptography</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/malware-honeypot/"><div class="card-body"> <em class="timeago small" date="2022-03-21 13:53:00 +0100" >Mar 21</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Obtaining malware samples using Honeypots</h3><div class="text-muted small"><p> This post presents a solution to capture a sample of malicious binaries distributed over the Internet. Post index Honeypot construction Honeypot analysis Honeypot construction It has been d...</p></div></div></a></div><div class="card"> <a href="/posts/TFM/"><div class="card-body"> <em class="timeago small" date="2022-09-18 06:37:00 +0200" >Sep 18</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Use of Natural Language Processing techniques for the automatic identification of TTPs in Threat Intelligence Reports.</h3><div class="text-muted small"><p> In this post I present my Master’s Thesis to conclude my studies in the official master’s degree in Cybersecurity of the UAH. I take as a starting point the open source platform, developed by MITR...</p></div></div></a></div><div class="card"> <a href="/posts/seg-ofensiva-explotacion-vuln-red/"><div class="card-body"> <em class="timeago small" date="2021-07-13 13:35:00 +0200" >Jul 13, 2021</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Explotación de vulnerabilidades en Red</h3><div class="text-muted small"><p> Durante los posts anteriores hemos visto métodos para recopilar y analizar información sobre nuestros objetivos. Durante este post veremos como explotar (en Red) aquellas vulnerabilidades que prese...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/seg-ofensiva-explotacion-vuln-red/" class="btn btn-outline-primary" prompt="Older"><p>Explotación de vulnerabilidades en Red</p></a> <a href="/posts/malware-honeypot/" class="btn btn-outline-primary" prompt="Newer"><p>Obtaining malware samples using Honeypots</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://www.linkedin.com/in/javifs97">Javier Fernández Santos</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/pentesting/">Pentesting</a> <a class="post-tag" href="/tags/nmap/">NMAP</a> <a class="post-tag" href="/tags/archive-org/">Archive.org</a> <a class="post-tag" href="/tags/armitage/">Armitage</a> <a class="post-tag" href="/tags/arpspoofing/">ARPspoofing</a> <a class="post-tag" href="/tags/automatizaci%C3%B3n/">Automatización</a> <a class="post-tag" href="/tags/bettercap/">Bettercap</a> <a class="post-tag" href="/tags/burpsuite/">BurpSuite</a> <a class="post-tag" href="/tags/cpe/">CPE</a> <a class="post-tag" href="/tags/cryptography/">Cryptography</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js"></script> <script> $(function() { function updateMermaid(event) { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { const mode = event.data.message; if (typeof mermaid === "undefined") { return; } let expectedTheme = (mode === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* Re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } let initTheme = "default"; if ($("html[mode=dark]").length > 0 || ($("html[mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches ) ) { initTheme = "dark"; } let mermaidConf = { theme: initTheme /* <default|dark|forest|neutral> */ }; /* Markdown converts to HTML */ $("pre").has("code.language-mermaid").each(function() { let svgCode = $(this).children().html(); $(this).addClass("unloaded"); $(this).after(`<div class=\"mermaid\">${svgCode}</div>`); }); mermaid.initialize(mermaidConf); window.addEventListener("message", updateMermaid); }); </script><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
